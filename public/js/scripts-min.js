"use strict";function asyncGeneratorStep(t,e,n,a,o,r,i){try{var c=t[r](i),d=c.value}catch(t){return void n(t)}c.done?e(d):Promise.resolve(d).then(a,o)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(a,o){var r=t.apply(e,n);function i(t){asyncGeneratorStep(r,a,o,i,c,"next",t)}function c(t){asyncGeneratorStep(r,a,o,i,c,"throw",t)}i(void 0)}))}}var mymap,marker,form=document.getElementById("form"),ipElement=document.getElementById("ip-adress"),locationElement=document.getElementById("location"),timezoneElement=document.getElementById("timezone"),providerElement=document.getElementById("provider"),myIcon=L.icon({iconUrl:"./assets/img/icon-location.svg"}),map=document.getElementById("mapid"),apiKey="at_KjEWSMTsnBIo97j1vuNqFMclIcTZC",showMap=function(t,e){map.textContent="",mymap=L.map("mapid",{zoomControl:!1}).setView([t,e],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(mymap),marker=L.marker([t,e],{icon:myIcon}).addTo(mymap)},getLocationData=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(e){var n,a,o,r,i=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"ipAddress",a="https://geo.ipify.org/api/v1?apiKey=".concat(apiKey,"&").concat(n,"=").concat(e),console.log(a),t.next=5,fetch(a);case 5:return o=t.sent,t.next=8,o.json();case 8:r=t.sent,mymap.setView([r.location.lat,r.location.lng],13),marker.remove(),marker=L.marker([r.location.lat,r.location.lng],{icon:myIcon}).addTo(mymap),ipElement.textContent=r.ip,locationElement.textContent="".concat(r.location.city,", ").concat(r.location.region," ").concat(r.locatiopostalCode),timezoneElement.textContent="UTC ".concat(r.location.timezone),providerElement.textContent=r.isp;case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getCurrentLocationData=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="https://geo.ipify.org/api/v1?apiKey=".concat(apiKey),t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.json();case 6:a=t.sent,showMap(a.location.lat,a.location.lng),ipElement.textContent=a.ip,locationElement.textContent="".concat(a.location.city,", ").concat(a.location.region," ").concat(a.location.postalCode),timezoneElement.textContent="UTC ".concat(a.location.timezone),providerElement.textContent=a.isp;case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),validateUrl=function(t){return!!/(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z0-9][a-z0-9-]{0,61}[a-z0-9]/g.test(t)},validateIP=function(t){return!!/((^\s*((([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))\s*$)|(^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$))/g.test(t)};form.addEventListener("submit",(function(t){if(t.preventDefault(),validateIP(form.search.value))getLocationData(form.search.value);else if(validateUrl(form.search.value)){var e=form.search.value.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n\?\=]+)/im);getLocationData(e[1],"domain")}else;})),document.addEventListener("DOMContentLoaded",getCurrentLocationData);