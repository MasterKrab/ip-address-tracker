"use strict";function asyncGeneratorStep(t,e,n,o,a,i,r){try{var c=t[i](r),m=c.value}catch(t){return void n(t)}c.done?e(m):Promise.resolve(m).then(o,a)}function _asyncToGenerator(t){return function(){var e=this,n=arguments;return new Promise((function(o,a){var i=t.apply(e,n);function r(t){asyncGeneratorStep(i,o,a,r,c,"next",t)}function c(t){asyncGeneratorStep(i,o,a,r,c,"throw",t)}r(void 0)}))}}var mymap,marker,form=document.getElementById("form"),ipElement=document.getElementById("ip-adress"),locationElement=document.getElementById("location"),timezoneElement=document.getElementById("timezone"),providerElement=document.getElementById("provider"),myIcon=L.icon({iconUrl:"./assets/img/icon-location.svg"}),map=document.getElementById("mapid"),apiKey="at_KjEWSMTsnBIo97j1vuNqFMclIcTZC",showMap=function(t,e){map.textContent="",mymap=L.map("mapid",{zoomControl:!1}).setView([t,e],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(mymap),marker=L.marker([t,e],{icon:myIcon}).addTo(mymap)},getLocationData=function(t){var e="https://geo.ipify.org/api/v1?apiKey=".concat(apiKey,"&ipAddress=").concat(t);fetch(e).then((function(t){return t.json()})).then((function(t){mymap.setView([t.location.lat,t.location.lng],13),marker.remove(),marker=L.marker([t.location.lat,t.location.lng],{icon:myIcon}).addTo(mymap),ipElement.textContent=t.ip,locationElement.textContent="".concat(t.location.city,", ").concat(t.location.region," ").concat(t.location.postalCode),timezoneElement.textContent="UTC ".concat(t.location.timezone),providerElement.textContent=t.isp})).catch(form.ip.setCustomValidity("Invalid IP adress"))},getCurrentLocationData=function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(){var e,n,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="https://geo.ipify.org/api/v1?apiKey=".concat(apiKey),t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.json();case 6:o=t.sent,showMap(o.location.lat,o.location.lng),ipElement.textContent=o.ip,locationElement.textContent="".concat(o.location.city,", ").concat(o.location.region," ").concat(o.location.postalCode),timezoneElement.textContent="UTC ".concat(o.location.timezone),providerElement.textContent=o.isp;case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();form.addEventListener("submit",(function(t){t.preventDefault(),form.ip.validity.valid&&getLocationData(form.ip.value)})),document.addEventListener("DOMContentLoaded",getCurrentLocationData);